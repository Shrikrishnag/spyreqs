(function(window){"use strict";var appUrl,hostUrl,queryParams,executor,baseUrl,targetStr,notAnApp_Flag=0,say,rest,jsom,spyreqs,spyreqs_version="0.0.7";if(typeof window.console!=="undefined"){say=function(what){window.console.log(what)}}else if(typeof window.top!=="undefined"&&typeof window.top.console!=="undefined"){say=function(what){window.top.console.log(what)}}else if(typeof window.opener!=="undefined"&&typeof window.opener.console!=="undefined"){say=function(what){window.opener.console.log(what)}}else{say=function(){}}function getAsync(url){var defer=new $.Deferred;executor.executeAsync({url:url,method:"GET",dataType:"json",headers:{Accept:"application/json;odata=verbose"},success:function(data){defer.resolve(JSON.parse(data.body))},fail:function(error){defer.reject(error)}});return defer.promise()}function getFile(url){var defer=new $.Deferred;executor.executeAsync({url:url,method:"GET",success:function(data){defer.resolve(data.body)},fail:function(error){defer.reject(error)}});return defer.promise()}function addFile(url,file){var defer=new $.Deferred;executor.executeAsync({url:url,method:"POST",headers:{Accept:"application/json; odata=verbose"},contentType:"application/json;odata=verbose",body:file,success:function(data){defer.resolve(JSON.parse(data.body))},fail:function(error){defer.reject(error)}});return defer.promise()}function addFolder(url,data){var defer=new $.Deferred;executor.executeAsync({url:url,method:"POST",headers:{ACCEPT:"application/json;odata=verbose","Content-Type":"application/json;odata=verbose"},contentType:"application/json;odata=verbose",body:JSON.stringify(data),success:function(data){defer.resolve(JSON.parse(data.body))},fail:function(error){defer.reject(error)}});return defer.promise()}function deleteAsync(url,etag){var defer=new $.Deferred;executor.executeAsync({url:url,method:"POST",headers:{Accept:"application/json;odata=verbose","X-HTTP-Method":"DELETE","If-Match":etag?etag:"*"},success:function(data){defer.resolve(data)},fail:function(error){defer.reject(error)}});return defer.promise()}function updateAsync(url,data){var defer=new $.Deferred;executor.executeAsync({url:url,method:"POST",body:JSON.stringify(data),headers:{Accept:"application/json;odata=verbose","Content-Type":"application/json;odata=verbose","X-HTTP-Method":"MERGE","If-Match":data.__metadata&&data.__metadata.etag?data.__metadata.etag:"*"},success:function(data){defer.resolve(data)},fail:function(error){defer.reject(error)}});return defer.promise()}function createAsync(url,data){var defer=new $.Deferred;executor.executeAsync({url:url,method:"POST",body:JSON.stringify(data),headers:{Accept:"application/json;odata=verbose","Content-Type":"application/json;odata=verbose"},success:function(data){defer.resolve(JSON.parse(data.body))},fail:function(error){defer.reject(error)}});return defer.promise()}function checkQuery(query){if(typeof query==="undefined"||typeof query!=="string"&&!(query instanceof String)){return""}return query}function newRemoteContextInstance(){var returnObj={},context,factory,appContextSite;if(!SP.ClientContext){say("SP.ClientContext not loaded");return null}context=new SP.ClientContext(appUrl);factory=new SP.ProxyWebRequestExecutorFactory(appUrl);context.set_webRequestExecutorFactory(factory);appContextSite=new SP.AppContextSite(context,hostUrl);returnObj.context=context;returnObj.factory=factory;returnObj.appContextSite=appContextSite;return returnObj}function newLocalContextInstance(){var returnObj={},context,appContextSite;if(!SP.ClientContext){say("SP.ClientContext not loaded");return null}context=new SP.ClientContext(appUrl);returnObj.context=context;returnObj.appContextSite=context;return returnObj}function urlParamsObj(){if(window.location.search){var param_array=document.location.search.substring(1).split("&"),theLength=param_array.length,params={},i=0,x;for(;i<theLength;i++){x=param_array[i].toString().split("=");params[x[0]]=x[1]}return params}return{}}function buildQueryString(str,param,val){var ind=str.indexOf("?");if(ind>-1){var param_array=str.substring(ind+1).split("&");var params={};var theLength=param_array.length;for(var i=0;i<theLength;i++){var x=param_array[i].toString().split("=");params[x[0]]=x[1]}params[param]=val;var attached="?";for(var key in params){attached+=key+"="+params[key]+"&"}attached=attached.substr(0,attached.length-1);return String(str.substr(0,ind)+attached)}return String(str+"?"+param+"="+val)}queryParams=urlParamsObj();if(typeof queryParams.SPAppWebUrl!=="undefined"){appUrl=decodeURIComponent(queryParams.SPAppWebUrl);if(appUrl.indexOf("#")!==-1){appUrl=appUrl.split("#")[0]}}else{notAnApp_Flag++}if(typeof queryParams.SPHostUrl!=="undefined"){hostUrl=decodeURIComponent(queryParams.SPHostUrl);targetStr="&@target='"+hostUrl+"'";baseUrl=appUrl+"/_api/SP.AppContextSite(@target)/";executor=new SP.RequestExecutor(appUrl)}else{notAnApp_Flag++}if(notAnApp_Flag==2){var url=window.location.href;appUrl=hostUrl=url.substring(0,url.indexOf("/Pages"));$.getScript(hostUrl+"/_layouts/15/SP.RequestExecutor.js").done(function(script,textStatus){say("loaded: RequestExecutor.js");executor=new SP.RequestExecutor(hostUrl)}).fail(function(script,textStatus){say("could not load: RequestExecutor.js")});if(!SP.ClientContext){SP.SOD.executeFunc("sp.js","SP.ClientContext.get_current",function(){say("loaded: sp.js")})}else{say("sp.js is already loaded")}}else if(notAnApp_Flag==1){say("query param (SPHostUrl or SPAppWebUrl) is misssing")}function mirrorAppFunctions(obj,properties){var keys,newKey;properties.forEach(function(prop){keys=Object.keys(obj[prop]);keys.forEach(function(key){if(key.indexOf("App")!==-1){newKey=key.replace("App","Web");obj[prop][newKey]=obj[prop][key]}})});return obj}rest={createList:function(url,list){var data={__metadata:{type:"SP.List"},BaseTemplate:list.Template,Title:list.Title};return createAsync(url,data)},addListField:function(url,field,fieldType){field.__metadata={type:typeof fieldType!=="undefined"?fieldType:"SP.Field"};return createAsync(url,field)}};jsom={createListFields:function(context,SPlist,fieldsObj){var field,defer,result;field=fieldsObj.shift();createListField();function createListField(){var xmlStr,choice,attr;if(typeof defer==="undefined"){defer=new $.Deferred}if(typeof field.Type==="undefined"){field.Type="Text"}if(typeof field.DisplayName==="undefined"){field.DisplayName=field.Name}if(field.Type!=="Lookup"){xmlStr="<Field ";for(attr in field){if(attr!=="choices"){xmlStr+=attr+'="'+field[attr]+'" '}}xmlStr+=">";if(field.Type==="Choice"){xmlStr+="<CHOICES>";for(choice in field.choices){xmlStr+="<CHOICE>"+field.choices[choice]+"</CHOICE>"}xmlStr+="</CHOICES>"}xmlStr+="</Field>"}else{xmlStr+=""}result=SPlist.get_fields().addFieldAsXml(xmlStr,true,SP.AddFieldOptions.defaultValue);context.load(SPlist);context.executeQueryAsync(success,fail)}function success(){if(fieldsObj.length>0){field=fieldsObj.shift();createListField()}else{defer.resolve(result)}}function fail(sender,args){var error={sender:sender,args:args};defer.reject(error)}return defer.promise()},createList:function(c,listObj){var web,theList,listCreationInfo,template,field,defer=new $.Deferred,val_temp,fn_temp,isValidAttrBool,lciAttrs=["url","description","documentTemplateType","customSchemaXml","dataSourceProperties","quickLaunchOption","templateFeatureId"],listAttrs=["contentTypesEnabled","defaultContentApprovalWorkflowId","defaultDisplayFormUrl","defaultEditFormUrl","defaultNewFormUrl","documentTemplateUrl","draftVersionVisibility","enableAttachments","enableFolderCreation","enableMinorVersions","enableModeration","enableVersioning","forceCheckout","hidden","isApplicationList","isSiteAssetsLibrary","multipleDataList","noCrawl","onQuickLaunch","validationFormula","validationMessage","direction"];web=c.appContextSite.get_web();listCreationInfo=new SP.ListCreationInformation;if(typeof listObj.title==="undefined"){say("createList cannot create without .title");var args={get_message:function(){return"createList cannot create without .title"},get_stackTrace:function(){return null}};setTimeout(fail(null,args),500);return defer.promise()}listCreationInfo.set_title(listObj.title);if(typeof listObj.template==="undefined"){template=SP.ListTemplateType.genericList}else if(isNaN(listObj.template)){template=SP.ListTemplateType[listObj.template]}else{template=listObj.template}listCreationInfo.set_templateType(template);for(var attr in listObj){val_temp=listObj[attr];fn_temp="set_"+attr;if(typeof listCreationInfo[fn_temp]=="function"){listCreationInfo[fn_temp](val_temp)}}theList=web.get_lists().add(listCreationInfo);for(var attr in listObj){val_temp=listObj[attr];fn_temp="set_"+attr;if(listAttrs.indexOf(attr)>-1){theList[fn_temp](val_temp)}}theList.update();c.context.load(theList);c.context.executeQueryAsync(success,fail);function success(){if(listObj.fields){$.when(jsom.createListFields(c.context,theList,listObj.fields)).then(function(data){defer.resolve(listObj)},function(error){defer.reject(error)})}else{defer.resolve(listObj)}}function fail(sender,args){var error={sender:sender,args:args};defer.reject(error)}return defer.promise()},addListItem:function(c,listTitle,itemObj){var web,theList,theListItem,prop,itemCreateInfo,defer=new $.Deferred;web=c.appContextSite.get_web();theList=web.get_lists().getByTitle(listTitle);itemCreateInfo=new SP.ListItemCreationInformation;theListItem=theList.addItem(itemCreateInfo);for(prop in itemObj){theListItem.set_item(prop,itemObj[prop])}theListItem.update();c.context.load(theListItem);c.context.executeQueryAsync(success,fail);function success(){defer.resolve(theListItem.get_id())}function fail(sender,args){var error={sender:sender,args:args};defer.reject(error)}return defer.promise()},getItems:function(c,listTitle,query){var web,theList,resultCollection,defer=new $.Deferred;web=c.appContextSite.get_web();theList=web.get_lists().getByTitle(listTitle);var camlQuery=new SP.CamlQuery;camlQuery.set_viewXml(query);resultCollection=theList.getItems(camlQuery);c.context.load(resultCollection);c.context.executeQueryAsync(success,fail);function success(){defer.resolve(resultCollection)}function fail(sender,args){var error={sender:sender,args:args};defer.reject(error)}return defer.promise()},updateListItem:function(c,listTitle,itemObj,itemId){var web,theList,theListItem,prop,itemId,itemCreateInfo,defer=new $.Deferred;web=c.appContextSite.get_web();theList=web.get_lists().getByTitle(listTitle);theListItem=theList.getItemById(itemId);for(prop in itemObj){theListItem.set_item(prop,itemObj[prop])}theListItem.update();c.context.load(theListItem);c.context.executeQueryAsync(success,fail);function success(){defer.resolve(itemId)}function fail(sender,args){var error={sender:sender,args:args};defer.reject(error)}return defer.promise()},checkList:function(c,listTitle){var web,collectionList,defer=new $.Deferred;if(!c){var args={get_message:function(){return"SP.ClientContext not loaded"},get_stackTrace:function(){return null}};setTimeout(fail(null,args),500);return defer.promise()}web=c.appContextSite.get_web();collectionList=web.get_lists();c.context.load(collectionList,"Include(Title)");c.context.executeQueryAsync(success,fail);function success(){var listInfo="",answerBool=false,listEnumerator=collectionList.getEnumerator();while(listEnumerator.moveNext()){var oList=listEnumerator.get_current();if(oList.get_title()==listTitle){answerBool=true;break}}say(answerBool);defer.resolve(answerBool)}function fail(sender,args){var error={sender:sender,args:args};defer.reject(error)}return defer.promise()},removeRecentElemByTitle:function(c,elemTitle){var ql=c.appContextSite.get_web().get_navigation().get_quickLaunch(),defer=new $.Deferred;c.context.load(ql);c.context.executeQueryAsync(function(){var objEnumerator=ql.getEnumerator(),navItem;while(objEnumerator.moveNext()){navItem=objEnumerator.get_current();if(navItem.get_title()=="Recent"){var ch=navItem.get_children();c.context.load(ch);c.context.executeQueryAsync(function(){var childsEnum=ch.getEnumerator(),childItem,foundBool=false;while(childsEnum.moveNext()){childItem=childsEnum.get_current();if(childItem.get_title()==elemTitle){foundBool=true;childItem.deleteObject();c.context.load(ql);c.context.executeQueryAsync(success,fail);break}}if(!foundBool){var args={get_message:function(){return"Element was not found"},get_stackTrace:function(){return null}};setTimeout(fail(null,args),500)}},fail)}}},fail);function success(){var msg="element removed from Recent";defer.resolve(msg)}function fail(sender,args){var error={sender:sender,args:args};defer.reject(error)}return defer.promise()},getList:function(c,listTitle){var web,theList,defer=new $.Deferred;web=c.appContextSite.get_web();theList=web.get_lists().getByTitle(listTitle);c.context.load(theList);c.context.executeQueryAsync(success,fail);function success(){defer.resolve(theList)}function fail(sender,args){var error={sender:sender,args:args};defer.reject(error)}return defer.promise()},deleteList:function(c,listTitle){var web,theList,defer=new $.Deferred;web=c.appContextSite.get_web();theList=web.get_lists().getByTitle(listTitle);theList.deleteObject();c.context.executeQueryAsync(success,fail);function success(){defer.resolve(listTitle+" deleted")}function fail(sender,args){var error={sender:sender,args:args};defer.reject(error)}return defer.promise()},getListPermissions:function(c,listTitle,userName){var web,theList,userPerms,defer=new $.Deferred;web=c.appContextSite.get_web();theList=web.get_lists().getByTitle(listTitle);userPerms=theList.getUserEffectivePermissions(userName);c.context.load(theList,"EffectiveBasePermissions");c.context.executeQueryAsync(success,fail);function success(){defer.resolve(userPerms)}function fail(sender,args){var error={sender:sender,args:args};defer.reject(error)}return defer.promise()}};spyreqs={rest:{getHostLists:function(query){var url=baseUrl+"web/lists?"+checkQuery(query)+targetStr;return getAsync(url)},getAppLists:function(query){var url=appUrl+"/_api/web/lists?"+checkQuery(query);return getAsync(url)},getHostListByTitle:function(listTitle,query){var url=baseUrl+"web/lists/getByTitle('"+listTitle+"')?"+checkQuery(query)+targetStr;return getAsync(url)},getAppListByTitle:function(listTitle,query){var url=appUrl+"/_api/web/lists/getByTitle('"+listTitle+"')?"+checkQuery(query);return getAsync(url)},getHostListItems:function(listTitle,query){var url=baseUrl+"web/lists/getByTitle('"+listTitle+"')/Items?"+checkQuery(query)+targetStr;return getAsync(url)},getAppListItems:function(listTitle,query){var url=appUrl+"/_api/web/lists/getByTitle('"+listTitle+"')/Items?"+checkQuery(query);return getAsync(url)},getHostListFields:function(listTitle,query){var url=baseUrl+"web/lists/getByTitle('"+listTitle+"')/Fields?"+checkQuery(query)+targetStr;return getAsync(url)},getAppListFields:function(listTitle,query){var url=appUrl+"/_api/web/lists/getByTitle('"+listTitle+"')/Fields?"+checkQuery(query);return getAsync(url)},createHostList:function(list){var url=baseUrl+"web/lists?"+targetStr;return rest.createList(url,list)},createAppList:function(list){var url=appUrl+"/_api/web/lists?";return rest.createList(url,list)},addHostListItem:function(listTitle,item){var url=baseUrl+"web/lists/getByTitle('"+listTitle+"')/Items?"+targetStr;return createAsync(url,item)},addAppListItem:function(listTitle,item){var url=appUrl+"/_api/web/lists/getByTitle('"+listTitle+"')/Items?";return createAsync(url,item)},deleteHostListItem:function(listTitle,itemId,etag){var url=baseUrl+"web/lists/getByTitle('"+listTitle+"')/Items("+itemId+")?"+targetStr;return deleteAsync(url,etag)},deleteAppListItem:function(listTitle,itemId,etag){var url=appUrl+"/_api/web/lists/getByTitle('"+listTitle+"')/Items("+itemId+")?";return deleteAsync(url,etag)},updateHostList:function(list){var url=baseUrl+"web/lists/getByTitle('"+list.Title+"')?"+targetStr;return updateAsync(url,list)},updateHostListItem:function(listTitle,item){var url=baseUrl+"web/lists/getByTitle('"+listTitle+"')/Items("+item.Id+")?"+targetStr;return updateAsync(url,item)},updateAppListItem:function(listTitle,item){var url=appUrl+"/_api/web/lists/getByTitle('"+listTitle+"')/Items("+item.Id+")?";return updateAsync(url,item)},updateHostListField:function(listTitle,field){var url=baseUrl+"web/lists/getByTitle('"+listTitle+"')/Fields(guid'"+field.Id+"')?"+targetStr;return updateAsync(url,field)},updateAppListField:function(listTitle,field){var url=appUrl+"/_api/web/lists/getByTitle('"+listTitle+"')/Fields(guid'"+field.Id+"')?";return updateAsync(url,field)},addHostListField:function(listGuid,field,fieldType){var url=baseUrl+"web/lists(guid'"+listGuid+"')/Fields?"+targetStr;return rest.addListField(url,field,fieldType)},addAppListField:function(listGuid,field,fieldType){var url=appUrl+"/_api/web/lists(guid'"+listGuid+"')/Fields?";return rest.addListField(url,field,fieldType)},getCurrentUser:function(){var url=baseUrl+"/web/CurrentUser?"+targetStr;return getAsync(url)},getHostFile:function(fileUrl){var url=baseUrl+"web/GetFileByServerRelativeUrl('"+fileUrl+"')/$value?"+targetStr;return getFile(url)},getAppFile:function(fileUrl){var url=appUrl+"/_api/web/GetFileByServerRelativeUrl('"+fileUrl+"')/$value?";return getFile(url)},getHostFolderFiles:function(folderName){var url=baseUrl+"web/GetFolderByServerRelativeUrl('"+folderName+"')/Files?"+targetStr;return getAsync(url)},getHostFolderFolders:function(folderName){var url=baseUrl+"web/GetFolderByServerRelativeUrl('"+folderName+"')/Folders?"+targetStr;return getAsync(url)},addHostFolder:function(documentLibrary,folderName){var url=baseUrl+"web/folders?"+targetStr,folderName=documentLibrary+"/"+folderName,data={__metadata:{type:"SP.Folder"},ServerRelativeUrl:folderName};return addFolder(url,data)},addHostFile:function(folderName,fileName,file){var url=baseUrl+"web/GetFolderByServerRelativeUrl('"+folderName+"')/Files/Add(url='"+fileName+"',overwrite=true)?"+targetStr;return addFile(url,file)},addAppFile:function(folderName,fileName,file){var url=appUrl+"/_api/web/GetFolderByServerRelativeUrl('"+folderName+"')/Files/Add(url='"+fileName+"',overwrite=true)?";return addFile(url,file)},getHostListItemAttachments:function(listTitle,itemId){var url=baseUrl+"web/lists/getByTitle('"+listTitle+"')/Items("+itemId+")/AttachmentFiles?"+targetStr;return getAsync(url)},addHostListItemAttachment:function(listTitle,itemId,fileName,file){var url=baseUrl+"web/lists/getByTitle('"+listTitle+"')/Items("+itemId+")/AttachmentFiles/add(FileName='"+fileName+"')?"+targetStr;return createAsync(url,file)},getSiteUsers:function(query){var url=baseUrl+"web/SiteUsers?"+checkQuery(query)+targetStr;return getAsync(url)},breakRoleInheritanceOfHostList:function(listTitle){var defer=new $.Deferred,url=baseUrl+"web/lists/getByTitle('"+listTitle+"')/breakroleinheritance(true)?"+targetStr;executor.executeAsync({url:url,method:"POST",headers:{Accept:"application/json;odata=verbose"},success:defer.resolve,error:defer.reject});return defer.promise()},breakRoleInheritanceOfAppList:function(listTitle){var defer=new $.Deferred,url=appUrl+"/_api/web/lists/getByTitle('"+listTitle+"')/breakroleinheritance(true)?";executor.executeAsync({url:url,method:"POST",headers:{Accept:"application/json;odata=verbose"},success:defer.resolve,error:defer.reject});return defer.promise()},givePermissionToGroupToAppList:function(listTitle,permissionName,groupName){var groupId;return this.breakRoleInheritanceOfAppList(listTitle).then(function(){var url=appUrl+"/_api/web/sitegroups/getByName('"+groupName+"')?$select=Id";return getAsync(url)}).then(function(groupData){var url;groupId=groupData.d.Id;url=appUrl+"/_api/web/lists/getbytitle('"+listTitle+"')/roleassignments/getbyprincipalid('"+groupId+"')";return deleteAsync(url)}).then(function(){var url=appUrl+"/_api/web/roledefinitions/getByName('"+permissionName+"')?select=Id";return getAsync(url)}).done(function(permissionData){var url=appUrl+"/_api/web/lists/getbytitle('"+listTitle+"')/roleassignments/"+"addroleassignment(principalid="+groupId+",roledefid="+permissionData.d.Id+")",defer=new $.Deferred;executor.executeAsync({url:url,method:"POST",headers:{Accept:"application/json;odata=verbose"},success:defer.resolve,error:defer.reject});return defer.promise()})},getHostListRoleAssigmnent:function(listTitle,userId){var url=baseUrl+"web/lists/getbytitle('"+listTitle+"')/roleassignments/getbyprincipalid('"+userId+"')?"+targetStr;return getAsync(url)}},jsom:{checkHostList:function(listTitle){var c=newRemoteContextInstance();return jsom.checkList(c,listTitle)},checkAppList:function(listTitle){var c=newLocalContextInstance();return jsom.checkList(c,listTitle)},getHostList:function(listTitle){var c=newRemoteContextInstance();return jsom.getList(c,listTitle)},getAppList:function(listTitle){var c=newLocalContextInstance();return jsom.getList(c,listTitle)},deleteHostList:function(listTitle){var c=newRemoteContextInstance();return jsom.deleteList(c,listTitle)},deleteAppList:function(listTitle){var c=newLocalContextInstance();return jsom.deleteList(c,listTitle)},getAppListPermissions:function(listTitle,userName){var c=newLocalContextInstance();return jsom.getListPermissions(c,listTitle,userName)},getHostListItems:function(listTitle,query){var c=newRemoteContextInstance();return jsom.getItems(c,listTitle,query)},getAppListItems:function(listTitle,query){var c=newLocalContextInstance();return jsom.getItems(c,listTitle,query)},addHostListItem:function(listTitle,itemObj){var c=newRemoteContextInstance();return jsom.addListItem(c,listTitle,itemObj)},addAppListItem:function(listTitle,itemObj){var c=newLocalContextInstance();return jsom.addListItem(c,listTitle,itemObj)},updateAppListItem:function(listTitle,itemObj,itemId){var c=newLocalContextInstance();return jsom.updateListItem(c,listTitle,itemObj,itemId)},updateHostListItem:function(listTitle,itemObj,itemId){var c=newRemoteContextInstance();return jsom.updateListItem(c,listTitle,itemObj,itemId)},removeHostRecentElemByTitle:function(elemTitle){var c=newRemoteContextInstance();return jsom.removeRecentElemByTitle(c,elemTitle)},removeAppRecentElemByTitle:function(elemTitle){var c=newLocalContextInstance();return jsom.removeRecentElemByTitle(c,elemTitle)},createHostList:function(listObj){var c=newRemoteContextInstance();return jsom.createList(c,listObj)},createAppList:function(listObj){var c=newLocalContextInstance();return jsom.createList(c,listObj)},createHostSite:function(webToCreate){var web,webCreationInfo,newWeb;web=appContextSite.get_web();webCreationInfo=new SP.WebCreationInformation;webCreationInfo.set_title(webToCreate.Title);webCreationInfo.set_webTemplate(webToCreate.Template);webCreationInfo.set_url(webToCreate.Url);webCreationInfo.set_language(webToCreate.language);webCreationInfo.set_useSamePermissionsAsParentSite(webToCreate.inheritPerms);newWeb=web.get_webs().add(webCreationInfo);context.load(newWeb);context.executeQueryAsync(success,fail);function success(){var result=newWeb.get_title()+" created.";alert(result)}function fail(sender,args){alert("Request failed. "+args.get_message()+"\n"+args.get_stackTrace())}}},utils:{urlParamsObj:urlParamsObj,buildQueryString:buildQueryString,say:say,getRegionalSettings:function(query){var url=baseUrl+"/web/RegionalSettings?"+checkQuery(query)+targetStr;return getAsync(url)},getAppUrl:function(){return appUrl},getHostUrl:function(){return hostUrl}},version:function(){say("Hello, spyreqs ver "+spyreqs_version)}};window.spyreqs=mirrorAppFunctions(spyreqs,["rest","jsom","utils"])})(window);
//# sourceMappingURL=min/spyreqs.min.js.map