(function(n){"use strict";function st(){s=typeof n.console!="undefined"?function(t){n.console.log(t)}:typeof n.top!="undefined"&&typeof n.top.console!="undefined"?function(t){n.top.console.log(t)}:typeof n.opener!="undefined"&&typeof n.opener.console!="undefined"?function(t){n.opener.console.log(t)}:function(){}}function ht(){function h(){SP.RequestExecutor?(u="&@target='"+c+"'",r=t+"/_api/SP.AppContextSite(@target)/",l=new SP.RequestExecutor(t)):s("SP.RequestExecutor not available")}function v(t){var r=a(t),u=n.location.host.split(".")[0],i=u.split("-"),f=i[i.length-1];return r.replace("-"+f,"")}function y(){return n.location.origin||(n.location.origin=n.location.protocol+"//"+n.location.hostname+(n.location.port?":"+n.location.port:"")),t=n.location.origin+a(n.location.pathname),t.toLowerCase().substring(t.length-6)=="/pages"&&(t=t.slice(0,t.lastIndexOf("/"))),t}function a(n){return n.slice(0,n.lastIndexOf("/"))}function w(){i="no app";tt=!1;var f=n.location.href;t=c=f.substring(0,f.indexOf("/Pages"));t.length<1&&(t=c=f.substring(0,f.indexOf("/15")));t.length>1?(s("spyreqs tries to get: "+c+"/15/SP.RequestExecutor.js"),$.getScript(c+"/15/SP.RequestExecutor.js").done(function(){s("loaded: RequestExecutor.js");l=new SP.RequestExecutor(c);u="&@target='"+c+"'";r=t+"/_api/SP.AppContextSite(@target)/"}).fail(function(){s("could not load: RequestExecutor.js")})):s("spyreqs not in SharePoint 2013");SP.ClientContext?(s("sp.js is already loaded"),typeof n.onSpyreqsReady=="function"&&n.onSpyreqsReady()):(s("spyreqs is waiting for sp.js"),e=setInterval(k,500))}function b(n){var i=n.split(".")[0],t=i.split("-"),r=t[t.length-1];return r.length==14}function k(){o?clearInterval(e):SP.SOD.executeFunc("sp.js","SP.ClientContext.get_current",function(){s("loaded: sp.js");o||(typeof n.onSpyreqsReady=="function"&&n.onSpyreqsReady(),o=!0);clearInterval(e)})}var e,o=!1,i="",f=n.localStorage;p=ot();typeof p.SPAppWebUrl!="undefined"?(t=decodeURIComponent(p.SPAppWebUrl),t.indexOf("#")!==-1&&(t=t.split("#")[0])):f.spyreqsAppUrl?(t=f.spyreqsAppUrl,i="storage"):d++;typeof p.SPHostUrl!="undefined"?(c=decodeURIComponent(p.SPHostUrl),h()):f.spyreqsHostUrl?(c=f.spyreqsHostUrl,i="storage",h()):d++;d!=0?b(n.location.host)?(t=decodeURIComponent(y()),c=decodeURIComponent(v(t)),h(),i="app - auto discover",s("spyreqs assumed: appUrl: "+t+" - hostUrl:"+c)):w():i==""&&(i="app");s("spyreqs init mode: "+i);i!="no app"&&(f.spyreqsAppUrl=t,f.spyreqsHostUrl=c)}function ct(n){var t=new $.Deferred,i=new FileReader;return i.onload=function(n){t.resolve(n.target.result)},i.onerror=function(){t.reject({error:e.target.error})},i.onprogress=function(n){t.notify(n)},i.readAsArrayBuffer(n),t.promise()}function v(n){var t=new $.Deferred;return l.executeAsync({url:n,method:"POST",headers:{Accept:"application/json;odata=verbose"},success:t.resolve,error:t.reject}),t.promise()}function h(n){var t=new $.Deferred;return l.executeAsync({url:n,method:"GET",dataType:"json",headers:{Accept:"application/json;odata=verbose"},success:function(n){t.resolve(JSON.parse(n.body))},fail:function(n){t.reject(n)},error:function(n){t.reject(n)}}),t.promise()}function rt(n){var t=new $.Deferred;return l.executeAsync({url:n,method:"GET",success:function(n){t.resolve(n.body)},fail:function(n){t.reject(n)},error:function(n){t.reject(n)}}),t.promise()}function ut(n,t){var i=new $.Deferred;return l.executeAsync({url:n,method:"POST",headers:{Accept:"application/json;odata=verbose"},contentType:"application/json;odata=verbose",body:t,success:function(n){i.resolve(JSON.parse(n.body))},fail:function(n){i.reject(n)},error:function(n){i.reject(n)}}),i.promise()}function ft(n,t,i){function f(n,t){var i=new $.Deferred;return $.ajax({url:n,type:"POST",data:t,processData:!1,headers:{accept:"application/json;odata=verbose","X-RequestDigest":$("#__REQUESTDIGEST").val()},xhr:function(){return u.upload&&u.upload.addEventListener("progress",function(n){n.lengthComputable&&i.notify(n.loaded,n.loaded/n.total)},!1),u},success:function(n){i.resolve(n)},error:function(n){i.reject(n)}}),i.promise()}var r=new $.Deferred,u=i||new XMLHttpRequest;return ct(t).then(function(t){f(n,t).then(function(n){r.resolve(n)},function(n){r.reject(n)},function(n,t){r.notify(n,t)})},function(n){r.reject(n)}),{xhr:u,handler:r.promise()}}function et(n,t){var i=new $.Deferred;return l.executeAsync({url:n,method:"POST",headers:{ACCEPT:"application/json;odata=verbose","Content-Type":"application/json;odata=verbose"},contentType:"application/json;odata=verbose",body:JSON.stringify(t),success:function(n){i.resolve(JSON.parse(n.body))},fail:function(n){i.reject(n)},error:function(n){i.reject(n)}}),i.promise()}function nt(n,t){var i=new $.Deferred;return l.executeAsync({url:n,method:"POST",headers:{Accept:"application/json;odata=verbose","X-HTTP-Method":"DELETE","If-Match":t?t:"*"},success:function(n){i.resolve(n)},fail:function(n){i.reject(n)},error:function(n){i.reject(n)}}),i.promise()}function b(n,t){var i=new $.Deferred;return l.executeAsync({url:n,method:"POST",body:JSON.stringify(t),headers:{Accept:"application/json;odata=verbose","Content-Type":"application/json;odata=verbose","X-HTTP-Method":"MERGE","If-Match":t.__metadata&&t.__metadata.etag?t.__metadata.etag:"*"},success:function(n){i.resolve(n)},fail:function(n){i.reject(n)},error:function(n){i.reject(n)}}),i.promise()}function k(n,t){var i=new $.Deferred;return l.executeAsync({url:n,method:"POST",body:JSON.stringify(t),headers:{Accept:"application/json;odata=verbose","Content-Type":"application/json;odata=verbose"},success:function(n){i.resolve(JSON.parse(n.body))},fail:function(n){i.reject(n)},error:function(n){s("ajax error:"+n.statusText);i.reject(n)}}),i.promise()}function a(n){return typeof n=="undefined"||typeof n!="string"&&!(n instanceof String)?"":n}function o(){var n={},i,r,u;return SP.ClientContext?(i=new SP.ClientContext(t),r=new SP.ProxyWebRequestExecutorFactory(t),i.set_webRequestExecutorFactory(r),u=new SP.AppContextSite(i,c),n.context=i,n.factory=r,n.appContextSite=u,n):(s("SP.ClientContext not loaded"),null)}function f(){var n={},i;return SP.ClientContext?(i=tt?new SP.ClientContext(t):new SP.ClientContext.get_current,n.context=i,n.appContextSite=i,n):(s("SP.ClientContext was not loaded, loading now. Please try again"),SP.SOD.executeFunc("sp.js","SP.ClientContext.get_current",function(){s("loaded: sp.js, spyreqs ready")}),null)}function ot(){if(n.location.search){for(var r=document.location.search.substring(1).split("&"),f=r.length,u={},t=0,i;t<f;t++)i=r[t].toString().split("="),u[i[0]]=i[1];return u}return{}}function lt(n,t,i){var e=n.indexOf("?"),f,o,r,s;if(e>-1){var h=n.substring(e+1).split("&"),u={},c=h.length;for(f=0;f<c;f++)o=h[f].toString().split("="),u[o[0]]=o[1];u[t]=i;r="?";for(s in u)r+=s+"="+u[s]+"&";return r=r.substr(0,r.length-1),String(n.substr(0,e)+r)}return String(n+"?"+t+"="+i)}function at(n,t){var i,r;return t.forEach(function(t){i=Object.keys(n[t]);i.forEach(function(i){i.indexOf("App")!==-1&&(r=i.replace("App","Web"),n[t][r]=n[t][i])})}),n}var t,c,p,l,r,u,d=0,y={appWebProperties:{isUnloaded:!0},hostWebProperties:{isUnloaded:!0}},s,w,i,tt=!0,g,it="0.0.30";n.performance||(n.performance={});n.performance.now||(n.performance.now=function(){return Date.now()});st();ht();w={createList:function(n,t){var i={__metadata:{type:"SP.List"},BaseTemplate:t.Template,Title:t.Title};return k(n,i)},addListField:function(n,t,i){return t.__metadata={type:typeof i!="undefined"?i:"SP.Field"},k(n,t)}};i={createListFields:function(n,t,i){function e(){var i,e;if(typeof u=="undefined"&&(u=new $.Deferred),typeof r.Type=="undefined"&&(r.Type="Text"),typeof r.DisplayName=="undefined"&&(r.DisplayName=r.Name),r.Type!=="Lookup"){i="<Field ";for(e in r)e!=="choices"&&(i+=e+'="'+r[e]+'" ');i+=">";r.Type==="Choice"&&(i+="<CHOICES>",r.choices.forEach(function(n){i+="<CHOICE>"+n+"<\/CHOICE>"}),i+="<\/CHOICES>");i+="<\/Field>"}else i+="";f=t.get_fields().addFieldAsXml(i,!0,SP.AddFieldOptions.defaultValue);n.load(t);n.executeQueryAsync(o,s)}function o(){i.length>0?(r=i.shift(),e()):u.resolve(f)}function s(n,t){var i={sender:n,args:t};u.reject(i)}var r,u,f;return r=i.shift(),e(),u.promise()},createList:function(n,t){function p(){t.fields?$.when(i.createListFields(n.context,e,t.fields)).then(function(){f.resolve(t)},function(n){f.reject(n)}):f.resolve(t)}function v(n,t){var i={sender:n,args:t};f.reject(i)}var c,e,u,l,f=new $.Deferred,h,o,y=["contentTypesEnabled","defaultContentApprovalWorkflowId","defaultDisplayFormUrl","defaultEditFormUrl","defaultNewFormUrl","documentTemplateUrl","draftVersionVisibility","enableAttachments","enableFolderCreation","enableMinorVersions","enableModeration","enableVersioning","forceCheckout","hidden","isApplicationList","isSiteAssetsLibrary","multipleDataList","noCrawl","onQuickLaunch","validationFormula","validationMessage","direction"],a,r;if(c=n.appContextSite.get_web(),u=new SP.ListCreationInformation,typeof t.title=="undefined")return s("createList cannot create without .title"),a={get_message:function(){return"createList cannot create without .title"},get_stackTrace:function(){return null}},setTimeout(v(null,a),500),f.promise();u.set_title(t.title);l=typeof t.template=="undefined"?SP.ListTemplateType.genericList:isNaN(t.template)?SP.ListTemplateType[t.template]:t.template;u.set_templateType(l);for(r in t)h=t[r],o="set_"+r,typeof u[o]=="function"&&u[o](h);e=c.get_lists().add(u);for(r in t)h=t[r],o="set_"+r,y.indexOf(r)>-1&&e[o](h);return e.update(),n.context.load(e),n.context.executeQueryAsync(p,v),f.promise()},addListItem:function(n,t,i){function h(){f.resolve(r.get_id())}function c(n,t){var i={sender:n,args:t};f.reject(i)}var e,o,r,u,s,f=new $.Deferred;e=n.appContextSite.get_web();o=e.get_lists().getByTitle(t);s=new SP.ListItemCreationInformation;r=o.addItem(s);for(u in i)r.set_item(u,i[u]);return r.update(),n.context.load(r),n.context.executeQueryAsync(h,c),f.promise()},getListFields:function(n,t){function e(){u.resolve(r)}function o(n,t){var i={sender:n,args:t};u.reject(i)}var f,i,r,u=new $.Deferred;return f=n.appContextSite.get_web(),i=f.get_lists().getByTitle(t),r=i.get_fields(),n.context.load(i),n.context.load(r),n.context.executeQueryAsync(e,o),u.promise()},getItems:function(n,t,i){function s(){u.resolve(r)}function h(n,t){var i={sender:n,args:t};u.reject(i)}var e,o,r,u=new $.Deferred,f;return e=n.appContextSite.get_web(),o=e.get_lists().getByTitle(t),f=new SP.CamlQuery,f.set_viewXml(i),r=o.getItems(f),n.context.load(r),n.context.executeQueryAsync(s,h),u.promise()},handleItemsPaginated:function(n,t,i,r,u,f){function a(n,t,i,r){function f(n,t,i,r,e,s){l.getItemsPaginated(n,t,i,r,s,e).then(function(r){var h=r.items.get_data();o=o.concat(h);r.nextPage===!0?(s++,f(n,t,i,r.nextPagingInfo,e,s)):u.resolve()},function(n){u.reject(n)})}var u=new $.Deferred;return f(n,t,i,null,r,1),u.promise()}function h(n,t,i,r){var u=o.splice(0,i),f=!1;u.length>0?(s("spliced "+u.length+" items, remaining "+o.length),u.forEach(function(n){r(n,t)&&(c+=1,f||(f=!0))}),f?n.context.executeQueryAsync(function(){h(n,t,i,r)},function(n,t){e.reject({sender:n,args:t})}):h(n,t,i,r)):e.resolve({updatedItems:c})}var e=new $.Deferred,l=this,u=u?u:50,c=0,o=[];return a(n,t,i,u).then(function(){h(n,r,u,f)},function(n){e.reject(n)}),e.promise()},getItemsPaginated:function(n,t,i,r,u,f){function y(){o=e.get_listItemCollectionPosition()?e.get_listItemCollectionPosition().get_pagingInfo():null;c=u>1?"PagedPrev=TRUE&Paged=TRUE&p_ID="+e.itemAt(0).get_item("ID"):null;h.resolve({startItem:(u-1)*f+1,endItem:u*f-(f-e.get_count()),prevPage:u>1?!0:!1,previousPagingInfo:c,nextPage:o?!0:!1,nextPagingInfo:o,items:e})}function p(n,t){var i={sender:n,args:t};h.reject(i)}var a,v,s=new SP.CamlQuery,h=new $.Deferred,o,c,e,l=null;return u||(u=1),f||(f=10),a=n.appContextSite.get_web(),v=a.get_lists().getByTitle(t),i=i?i.replace("<\/View>","<RowLimit>"+f+"<\/RowLimit><\/View>"):"<View><RowLimit>"+f+"<\/RowLimit><\/View>",r&&(l=new SP.ListItemCollectionPosition,l.set_pagingInfo(r)),s.set_listItemCollectionPosition(l),s.set_viewXml(i),e=v.getItems(s),n.context.load(e),n.context.executeQueryAsync(y,p),h.promise()},updateListItem:function(n,t,i,r){function h(){e.resolve(r)}function c(n,t){var i={sender:n,args:t};e.reject(i)}var o,s,u,f,r,e=new $.Deferred;o=n.appContextSite.get_web();s=o.get_lists().getByTitle(t);u=s.getItemById(r);for(f in i)u.set_item(f,i[f]);return u.update(),n.context.load(u),n.context.executeQueryAsync(h,c),e.promise()},recycleListItem:function(n,t,i){function o(){r.resolve(i)}function s(n,t){var i={sender:n,args:t};r.reject(i)}var u,f,e,r=new $.Deferred;return u=n.appContextSite.get_web(),f=u.get_lists().getByTitle(t),e=f.getItemById(i),e.recycle(),n.context.executeQueryAsync(o,s),r.promise()},checkList:function(n,t){function o(){for(var n=!1,u=r.getEnumerator(),f;u.moveNext();)if(f=u.get_current(),f.get_title()==t){n=!0;break}i.resolve(n)}function e(n,t){var r={sender:n,args:t};i.reject(r)}var u,r,i=new $.Deferred,f;return n?(u=n.appContextSite.get_web(),r=u.get_lists(),n.context.load(r,"Include(Title)"),n.context.executeQueryAsync(o,e),i.promise()):(f={get_message:function(){return"SP.ClientContext not loaded"},get_stackTrace:function(){return null}},setTimeout(e(null,f),500),i.promise())},removeRecentElemByTitle:function(n,t,i){function e(){var n="element removed from Recent: "+t;f.resolve(n)}function r(n,t){var i={sender:n,args:t};f.reject(i)}var f=new $.Deferred,u;return i=i||["Recent"],i instanceof Array||(i=[i]),n.ql=n.appContextSite.get_web().get_navigation().get_quickLaunch(),u=n.ql,n.context.load(u),n.context.executeQueryAsync(function(){for(var s=u.getEnumerator(),f,h,c,o,l;s.moveNext();)f=s.get_current(),c=f.get_title(),$.inArray(c,i)!==-1&&(h=!0,o=f.get_children(),n.context.load(o),n.context.executeQueryAsync(function(){for(var f=o.getEnumerator(),i,s=!1,h;f.moveNext();)if(i=f.get_current(),i.get_title()==t){s=!0;i.deleteObject();n.context.load(u);n.context.executeQueryAsync(e,r);break}s||(h={get_message:function(){return"Recent Element was not found: "+t},get_stackTrace:function(){return null}},setTimeout(r(null,h),500))},r));h||(l={get_message:function(){return"Recent Node was not found: "+t},get_stackTrace:function(){return null}},setTimeout(r(null,l),500))},r),f.promise()},getList:function(n,t){function f(){r.resolve(i)}function e(n,t){var i={sender:n,args:t};r.reject(i)}var u,i,r=new $.Deferred;return u=n.appContextSite.get_web(),i=u.get_lists().getByTitle(t),n.context.load(i),n.context.executeQueryAsync(f,e),r.promise()},getLists:function(n,t){function e(){u.resolve(i)}function o(n,t){var i={sender:n,args:t};u.reject(i)}var f,i,r,u=$.Deferred();return f=n.appContextSite.get_web(),i=f.get_lists(),typeof t=="string"?r="Include("+t+")":Array.isArray(t)&&(r="Include("+t.join()+")"),r?n.context.load(i,r):n.context.load(i),n.context.executeQueryAsync(e,o),u.promise()},deleteList:function(n,t){function f(){i.resolve(t+" deleted")}function e(n,t){var r={sender:n,args:t};i.reject(r)}var r,u,i=new $.Deferred;return r=n.appContextSite.get_web(),u=r.get_lists().getByTitle(t),u.deleteObject(),n.context.executeQueryAsync(f,e),i.promise()},recycleList:function(n,t){function f(){i.resolve(t+" recycled")}function e(n,t){var r={sender:n,args:t};i.reject(r)}var r,u,i=new $.Deferred;return r=n.appContextSite.get_web(),u=r.get_lists().getByTitle(t),u.recycle(),n.context.executeQueryAsync(f,e),i.promise()},getListPermissions:function(n,t,i){function o(){u.resolve(e)}function s(n,t){var i={sender:n,args:t};u.reject(i)}var f,r,e,u=new $.Deferred;return f=n.appContextSite.get_web(),r=f.get_lists().getByTitle(t),e=r.getUserEffectivePermissions(i),n.context.load(r,"EffectiveBasePermissions"),n.context.executeQueryAsync(o,s),u.promise()},getListItemHasUniquePerms:function(n,t,i){function h(){for(var n,t=r.getEnumerator(),i;t.moveNext();)i=t.get_current(),n=i.get_hasUniqueRoleAssignments();u.resolve(n)}function c(n,t){var i={sender:n,args:t};u.reject(i)}var f,e,o,u=new $.Deferred,s=new SP.CamlQuery,r;return f=n.appContextSite.get_web(),e=f.get_lists().getByTitle(t),o=isNaN(i)?"<View><Query><Where><Eq><FieldRef Name='FileLeafRef'/><Value Type='File'>"+i+"<\/Value><\/Eq><\/Where><\/Query><\/View>":"<View><Query><Where><Eq><FieldRef Name='ID'/><Value Type='Counter'>"+i+"<\/Value><\/Eq><\/Where><\/Query><\/View>",s.set_viewXml(o),r=e.getItems(s),n.context.load(r,"Include(Title, DisplayName, HasUniqueRoleAssignments)"),n.context.executeQueryAsync(h,c),u.promise()},getAllListsHasUniquePerms:function(n){function u(){for(var r=[],u=i.getEnumerator(),f,n;u.moveNext();)n=u.get_current(),f={title:n.get_title(),hasUniqePerms:n.get_hasUniqueRoleAssignments()},r.push(f);t.resolve(r)}function f(n,i){var r={sender:n,args:i};t.reject(r)}var r,t=new $.Deferred,i;return r=n.appContextSite.get_web(),i=r.get_lists(),n.context.load(i,"Include(Title, HasUniqueRoleAssignments)"),n.context.executeQueryAsync(u,f),t.promise()},getListHasUniquePerms:function(n,t){function e(){for(var n=-1,e=r.getEnumerator(),u,o;e.moveNext();)if(u=e.get_current(),u.get_title()==t){n=u.get_hasUniqueRoleAssignments();break}n==-1?(o={get_message:function(){return"List was not found: "+elemTitle},get_stackTrace:function(){return null}},f(null,o)):i.resolve(n)}function f(n,t){var r={sender:n,args:t};i.reject(r)}var u,i=new $.Deferred,r;return u=n.appContextSite.get_web(),r=u.get_lists(),n.context.load(r,"Include(Title, HasUniqueRoleAssignments)"),n.context.executeQueryAsync(e,f),i.promise()},getCurrentUser:function(n){function i(){t.resolve(user)}function r(n,i){var r={sender:n,args:i};t.reject(r)}var t=new $.Deferred;return user=n.context.get_web().get_currentUser(),n.context.load(user),n.context.executeQueryAsync(i,r),t.promise()},getWebProperty:function(n,t,i){function e(){y[i]=u.get_fieldValues();var n=y[i][t];f.resolve(n)}function o(n,t){var i={sender:n,args:t};f.reject(i)}var r,u,f=new $.Deferred;return r=n.appContextSite.get_web(),u=r.get_allProperties(),r.update(),n.context.load(r),n.context.load(u),n.context.executeQueryAsync(e,o),f.promise()},setWebProperty:function(n,t,i,r){function o(n){y[r][t]=i;f.resolve(n)}function s(n,t){var i={sender:n,args:t};f.reject(i)}var u,e,f=new $.Deferred;return u=n.appContextSite.get_web(),e=u.get_allProperties(),e.set_item(t,i),u.update(),n.context.load(u),n.context.executeQueryAsync(o,s),f.promise()},deleteFile:function(n,t){function f(n){r.resolve(n)}function e(n,t){var i={sender:n,args:t};r.reject(i)}var i,u,r=new $.Deferred;return i=n.appContextSite.get_web(),u=i.getFileByServerRelativeUrl(t),n.context.load(i),u.deleteObject(),n.context.executeQueryAsync(f,e),r.promise()},createFile:function(n,t,i,r,u){function a(){s.resolve(o.get_serverRelativeUrl())}function v(n,t){s.reject(t.get_message())}function y(n){for(var r,e,i,t,o=n.length,u=0,f=0;f<o;f++)t=n.charCodeAt(f),u+=t<128?1:t<2048?2:t<65536?3:t<2097152?4:t<67108864?5:6;for(i=new Uint8Array(u),r=0,e=0;r<u;e++)t=n.charCodeAt(e),t<128?i[r++]=t:t<2048?(i[r++]=192+(t>>>6),i[r++]=128+(t&63)):t<65536?(i[r++]=224+(t>>>12),i[r++]=128+(t>>>6&63),i[r++]=128+(t&63)):t<2097152?(i[r++]=240+(t>>>18),i[r++]=128+(t>>>12&63),i[r++]=128+(t>>>6&63),i[r++]=128+(t&63)):t<67108864?(i[r++]=248+(t>>>24),i[r++]=128+(t>>>18&63),i[r++]=128+(t>>>12&63),i[r++]=128+(t>>>6&63),i[r++]=128+(t&63)):(i[r++]=252+t/1073741824,i[r++]=128+(t>>>24&63),i[r++]=128+(t>>>18&63),i[r++]=128+(t>>>12&63),i[r++]=128+(t>>>6&63),i[r++]=128+(t&63));return i}var c,l,f,o,s=new $.Deferred,h,e;for(c=n.appContextSite.get_web(),l=c.get_lists().getByTitle(t),f=new SP.FileCreationInformation,f.set_url(i),f.set_content(new SP.Base64EncodedByteArray),f.set_overwrite(u||!1),h=y(r),e=0;e<h.length;++e)f.get_content().append(h[e]);return o=l.get_rootFolder().get_files().add(f),n.context.load(o),n.context.executeQueryAsync(a,v),s.promise()},createFolder:function(n,t,i){var e=n.appContextSite.get_web(),o=e.get_lists().getByTitle(t),u,r,f=new $.Deferred;return r=new SP.ListItemCreationInformation,r.set_underlyingObjectType(SP.FileSystemObjectType.folder),r.set_leafName(i),u=o.addItem(r),u.update(),n.context.load(u),n.context.executeQueryAsync(function(){f.resolve(!0)},function(n,t){f.reject({sender:n,args:t})}),f.promise()}};g={rest:{getHostLists:function(n){var t=r+"web/lists?"+a(n)+u;return h(t)},getAppLists:function(n){var i=t+"/_api/web/lists?"+a(n);return h(i)},getHostListByTitle:function(n,t){var i=r+"web/lists/getByTitle('"+n+"')?"+a(t)+u;return h(i)},getAppListByTitle:function(n,i){var r=t+"/_api/web/lists/getByTitle('"+n+"')?"+a(i);return h(r)},getHostListItems:function(n,t){var i=r+"web/lists/getByTitle('"+n+"')/Items?"+a(t)+u;return h(i)},getAppListItems:function(n,i){var r=t+"/_api/web/lists/getByTitle('"+n+"')/Items?"+a(i);return h(r)},getHostListFields:function(n,t){var i=r+"web/lists/getByTitle('"+n+"')/Fields?"+a(t)+u;return h(i)},getAppListFields:function(n,i){var r=t+"/_api/web/lists/getByTitle('"+n+"')/Fields?"+a(i);return h(r)},createHostList:function(n){var t=r+"web/lists?"+u;return w.createList(t,n)},createAppList:function(n){var i=t+"/_api/web/lists?";return w.createList(i,n)},addHostListItem:function(n,t){var i=r+"web/lists/getByTitle('"+n+"')/Items?"+u;return k(i,t)},addAppListItem:function(n,i){var r=t+"/_api/web/lists/getByTitle('"+n+"')/Items?";return k(r,i)},deleteHostListItem:function(n,t,i){var f=r+"web/lists/getByTitle('"+n+"')/Items("+t+")?"+u;return nt(f,i)},deleteAppListItem:function(n,i,r){var u=t+"/_api/web/lists/getByTitle('"+n+"')/Items("+i+")?";return nt(u,r)},updateHostList:function(n){var t=r+"web/lists/getByTitle('"+n.Title+"')?"+u;return b(t,n)},updateHostListItem:function(n,t){var i=r+"web/lists/getByTitle('"+n+"')/Items("+t.Id+")?"+u;return b(i,t)},updateAppListItem:function(n,i){var r=t+"/_api/web/lists/getByTitle('"+n+"')/Items("+i.Id+")?";return b(r,i)},updateHostListField:function(n,t){var i=r+"web/lists/getByTitle('"+n+"')/Fields(guid'"+t.Id+"')?"+u;return b(i,t)},updateAppListField:function(n,i){var r=t+"/_api/web/lists/getByTitle('"+n+"')/Fields(guid'"+i.Id+"')?";return b(r,i)},addHostListField:function(n,t,i){var f=r+"web/lists(guid'"+n+"')/Fields?"+u;return w.addListField(f,t,i)},addAppListField:function(n,i,r){var u=t+"/_api/web/lists(guid'"+n+"')/Fields?";return w.addListField(u,i,r)},getCurrentUser:function(){var n=r+"/web/CurrentUser?"+u;return h(n)},getHostFile:function(n){var t=r+"web/GetFileByServerRelativeUrl('"+n+"')/$value?"+u;return rt(t)},getAppFile:function(n){var i=t+"/_api/web/GetFileByServerRelativeUrl('"+n+"')/$value?";return rt(i)},getHostFolderFiles:function(n){var t=r+"web/GetFolderByServerRelativeUrl('"+n+"')/Files?"+u;return h(t)},getHostFolderFolders:function(n){var t=r+"web/GetFolderByServerRelativeUrl('"+n+"')/Folders?"+u;return h(t)},getAppFolderFiles:function(n){var i=t+"/_api/web/GetFolderByServerRelativeUrl('"+n+"')/Files?";return h(i)},getAppFolderFolders:function(n){var i=t+"/_api/web/GetFolderByServerRelativeUrl('"+n+"')/Folders?";return h(i)},addAppFolder:function(n,i){var r=t+"/_api/web/folders?",i=n+"/"+i,u={__metadata:{type:"SP.Folder"},ServerRelativeUrl:i};return et(r,u)},addHostFolder:function(n,t){var i=r+"web/folders?"+u,t=n+"/"+t,f={__metadata:{type:"SP.Folder"},ServerRelativeUrl:t};return et(i,f)},addHostFile:function(n,t,i){var f=r+"web/GetFolderByServerRelativeUrl('"+n+"')/Files/Add(url='"+t+"',overwrite=true)?"+u;return ut(f,i)},addAppFile:function(n,i,r){var u=t+"/_api/web/GetFolderByServerRelativeUrl('"+n+"')/Files/Add(url='"+i+"',overwrite=true)?";return ut(u,r)},addHostBinaryFile:function(t,i,f,e,o){var s=new XMLHttpRequest,c=!!(!!(s.sendAsBinary||s.upload)||n.Uint8Array&&n.ArrayBuffer),l=!!(File&&(File.prototype.getAsDataURL||n.FileReader)&&c),h;return l?(f instanceof File||File instanceof Blob)?(e!==!1&&(e=!0),h=r+"/web/GetFolderByServerRelativeUrl('"+t+"')/Files/Add(url='"+i+"',overwrite="+e+")?"+u,ft(h,f,o)):(new $.Deferred).reject({mesage:"File cannot be read"}):(new $.Deferred).reject({mesage:"addHostBinaryFile is not supported by your browser"})},addAppBinaryFile:function(i,r,u,f,e){var o=new XMLHttpRequest,h=!!(!!(o.sendAsBinary||o.upload)||n.Uint8Array&&n.ArrayBuffer),c=!!(File&&(File.prototype.getAsDataURL||n.FileReader)&&h),s;return c?(u instanceof File||File instanceof Blob)?(f!==!1&&(f=!0),s=t+"/_api/web/GetFolderByServerRelativeUrl('"+i+"')/Files/Add(url='"+r+"',overwrite="+f+")?",ft(s,u,e)):(new $.Deferred).reject({mesage:"File cannot be read"}):(new $.Deferred).reject({mesage:"addAppBinaryFileWithProgress is not supported by your browser"})},getHostListItemAttachments:function(n,t){var i=r+"web/lists/getByTitle('"+n+"')/Items("+t+")/AttachmentFiles?"+u;return h(i)},addHostListItemAttachment:function(n,t,i,f){var e=r+"web/lists/getByTitle('"+n+"')/Items("+t+")/AttachmentFiles/add(FileName='"+i+"')?"+u;return k(e,f)},getSiteUsers:function(n){var t=r+"web/SiteUsers?"+a(n)+u;return h(t)},breakRoleInheritanceOfHostList:function(n,t,i){var e=new $.Deferred,t=t||"true",i=i||"false",f=r+"web/lists/getByTitle('"+n+"')/breakroleinheritance(copyRoleAssignments ="+t+",clearSubscopes ="+i+")?"+u;return v(f)},breakRoleInheritanceOfAppList:function(n,i,r){var f=new $.Deferred,i=i||"true",r=r||"false",u=t+"/_api/web/lists/getByTitle('"+n+"')/breakroleinheritance(copyRoleAssignments ="+i+",clearSubscopes ="+r+")?";return v(u)},resetRoleInheritanceOfAppList:function(n){var r=new $.Deferred,i=t+"/_api/web/lists/getByTitle('"+n+"')/resetroleinheritance?";return v(i)},resetRoleInheritanceOfHostList:function(n){var i=new $.Deferred,t=r+"web/lists/getByTitle('"+n+"')/resetroleinheritance?"+u;return v(t)},givePermissionToGroupToAppList:function(n,i,r){var u;return this.breakRoleInheritanceOfAppList(n).then(function(){var n=t+"/_api/web/sitegroups/getByName('"+r+"')?$select=Id";return h(n)}).then(function(i){var r;return u=i.d.Id,r=t+"/_api/web/lists/getbytitle('"+n+"')/roleassignments/getbyprincipalid('"+u+"')",nt(r)}).then(function(){var n=t+"/_api/web/roledefinitions/getByName('"+i+"')?select=Id";return h(n)}).done(function(i){var f=t+"/_api/web/lists/getbytitle('"+n+"')/roleassignments/addroleassignment(principalid="+u+",roledefid="+i.d.Id+")",r=new $.Deferred;return l.executeAsync({url:f,method:"POST",headers:{Accept:"application/json;odata=verbose"},success:r.resolve,error:r.reject}),r.promise()})},getHostListRoleAssigmnent:function(n,t){var i=r+"web/lists/getbytitle('"+n+"')/roleassignments/getbyprincipalid('"+t+"')?"+u;return h(i)},breakRoleInheritanceOfHostWeb:function(n,t){var f=new $.Deferred,n=n||"true",t=t||"false",i=r+"web/breakroleinheritance(copyRoleAssignments ="+n+",clearSubscopes ="+t+")?"+u;return v(i)},breakRoleInheritanceOfAppWeb:function(n,i){var u=new $.Deferred,n=n||"true",i=i||"false",r=t+"/_api/web/breakroleinheritance(copyRoleAssignments ="+n+",clearSubscopes ="+i+")?";return v(r)},resetRoleInheritanceOfHostWeb:function(){var t=new $.Deferred,n=r+"web/resetroleinheritance?"+u;return v(n)},resetRoleInheritanceOfAppWeb:function(){var i=new $.Deferred,n=t+"/_api/web/resetroleinheritance?";return v(n)},postAsync:v,getAsync:h},jsom:{checkHostList:function(n){var t=o();return i.checkList(t,n)},checkAppList:function(n){var t=f();return i.checkList(t,n)},getCurrentUser:function(){var n=f();return i.getCurrentUser(n)},getHostList:function(n){var t=o();return i.getList(t,n)},getAppList:function(n){var t=f();return i.getList(t,n)},getAppLists:function(n){var t=f();return i.getLists(t,n)},getHostLists:function(n){var t=o();return i.getLists(t,n)},deleteHostList:function(n){var t=o();return i.deleteList(t,n)},deleteAppList:function(n){var t=f();return i.deleteList(t,n)},recycleHostList:function(n){var t=o();return i.recycleList(t,n)},recycleAppList:function(n){var t=f();return i.recycleList(t,n)},getAppListPermissions:function(n,t){var r=f();return i.getListPermissions(r,n,t)},getHostListPermissions:function(n,t){s("CAUTION, spyreqs says: getHostListPermissions only works with full control on host web");var r=o();return i.getListPermissions(r,n,t)},getAppListFields:function(n){var t=f();return i.getListFields(t,n)},getHostListFields:function(n){var t=o();return i.getListFields(t,n)},getHostListItems:function(n,t){var r=o();return i.getItems(r,n,t)},getAppListItems:function(n,t){var r=f();return i.getItems(r,n,t)},getAppListItemsPaginated:function(n,t,r,u,e){var o=new f;return i.getItemsPaginated(o,n,t,r,u,e)},getHostListItemsPaginated:function(n,t,r,u,f){var e=new o;return i.getItemsPaginated(e,n,t,r,u,f)},updateHostListItemsPaginated:function(n,t,r,u){var f=new o,e=function(n,t){var r=!1;for(var i in t)n.get_item(i)!==t[i]&&(n.set_item(i,t[i]),r=!0);return r?(n.update(),!0):!1};return i.handleItemsPaginated(f,n,t,r,u,e)},recycleHostListItemsPaginated:function(n,t,r,u){var f=new o,e=function(n){return n.recycle(),!0};return i.handleItemsPaginated(f,n,t,r,u,e)},deleteHostListItemsPaginated:function(n,t,r,u){var f=new o,e=function(n){return n.deleteObject(),!0};return i.handleItemsPaginated(f,n,t,r,u,e)},addHostListItem:function(n,t){var r=o();return i.addListItem(r,n,t)},addAppListItem:function(n,t){var r=f();return i.addListItem(r,n,t)},updateAppListItem:function(n,t,r){var u=f();return i.updateListItem(u,n,t,r)},updateHostListItem:function(n,t,r){var u=o();return i.updateListItem(u,n,t,r)},recycleHostListItem:function(n,t){var r=o();return i.recycleListItem(r,n,t)},recycleAppListItem:function(n,t){var r=f();return i.recycleListItem(r,n,t)},removeHostRecentElemByTitle:function(n,t){var r=o();return i.removeRecentElemByTitle(r,n,t)},removeAppRecentElemByTitle:function(n,t){var r=f();return i.removeRecentElemByTitle(r,n,t)},createHostList:function(n){var t=o();return i.createList(t,n)},createAppList:function(n){var t=f();return i.createList(t,n)},createHostSite:function(n){function u(){var n=i.get_title()+" created.";alert(n)}function f(n,t){alert("Request failed. "+t.get_message()+"\n"+t.get_stackTrace())}var r,t,i;r=appContextSite.get_web();t=new SP.WebCreationInformation;t.set_title(n.Title);t.set_webTemplate(n.Template);t.set_url(n.Url);t.set_language(n.language);t.set_useSamePermissionsAsParentSite(n.inheritPerms);i=r.get_webs().add(t);context.load(i);context.executeQueryAsync(u,f)},getHostListItemHasUniquePerms:function(n,t){var r=o();return i.getListItemHasUniquePerms(r,n,t)},getAppListItemHasUniquePerms:function(n,t){var r=f();return i.getListItemHasUniquePerms(r,n,t)},getAllHostListsHasUniquePerms:function(){var n=o();return i.getAllListsHasUniquePerms(n)},getAllAppListsHasUniquePerms:function(){var n=f();return i.getAllListsHasUniquePerms(n)},getHostListHasUniquePerms:function(n){var t=o();return i.getListHasUniquePerms(t,n)},addUserToRoleTypeInAppWeb:function(n,t){var i=$.Deferred(),h=new f,r=h.appContextSite,u=r.get_web(),c=u.get_roleAssignments(),l,e,o,s=SP.RoleDefinitionBindingCollection.newObject(r);return n instanceof SP.User&&(n=n.get_id()),e=u.getUserById(n),o=u.get_roleDefinitions().getByType(t),s.add(o),l=c.add(e,s),r.executeQueryAsync(function(){i.resolve(!0)},function(n,t){var r={sender:n,args:t};i.reject(r)}),i.promise()},addUserToRoleTypeInAppList:function(n,t,i){var r=$.Deferred(),c=new f,u=c.appContextSite,e=u.get_web(),l=e.get_lists().getByTitle(i),a=l.get_roleAssignments(),o,s,v,h=SP.RoleDefinitionBindingCollection.newObject(u);return n instanceof SP.User&&(n=n.get_id()),o=e.getUserById(n),s=e.get_roleDefinitions().getByType(t),h.add(s),v=a.add(o,h),u.executeQueryAsync(function(){r.resolve(!0)},function(n,t){var i={sender:n,args:t};r.reject(i)}),r.promise()},addUserToRoleTypeInAppListItem:function(n,t,i,r){var u=$.Deferred(),c=new f,e=c.appContextSite,o=e.get_web(),l=o.get_lists().getByTitle(i).getItemById(r),a=l.get_roleAssignments(),v,s,y=o.get_roleDefinitions().getByType(t),h=SP.RoleDefinitionBindingCollection.newObject(e);return h.add(y),n instanceof SP.User&&(n=n.get_id()),s=o.getUserById(userId),v=a.add(s,h),e.executeQueryAsync(function(){u.resolve(!0)},function(n,t){var i={sender:n,args:t};u.reject(i)}),u.promise()},getAppListHasUniquePerms:function(n){var t=f();return i.getListHasUniquePerms(t,n)},getTestAppContext:function(){var n=f();return n.getter=n.appContextSite,n.loader=n.context,n},getTestHostContext:function(){var n=o();return n.getter=n.appContextSite,n.loader=n.context,n},getHostProperty:function(n){var t,r;return y.hostWebProperties.isUnloaded?(t=o(),i.getWebProperty(t,n,"hostWebProperties")):(r=y.hostWebProperties[n],(new $.Deferred).resolve(r).promise())},getAppProperty:function(n){var t,r;return y.appWebProperties.isUnloaded?(t=f(),i.getWebProperty(t,n,"appWebProperties")):(r=y.appWebProperties[n],(new $.Deferred).resolve(r).promise())},setHostProperty:function(n,t){var r=o();return i.setWebProperty(r,n,t,"hostWebProperties")},setAppProperty:function(n,t){var r=f();return i.setWebProperty(r,n,t,"appWebProperties")},createAppFile:function(n,t,r,u){var e=f();return i.createFile(e,n,t,r,u)},createHostFile:function(n,t,r,u){var f=o();return i.createFile(f,n,t,r,u)},createAppFolder:function(n,t){var r=f();return i.createFolder(r,n,t)},createHostFolder:function(n,t){var r=o();return i.createFolder(r,n,t)},deleteAppFile:function(n){var t=f();return i.deleteFile(t,n)},deleteHostFile:function(n){var t=o();return i.deleteFile(t,n)}},utils:{urlParamsObj:ot,buildQueryString:lt,say:s,getRegionalSettings:function(n){var t=r+"/web/RegionalSettings?"+a(n)+u;return h(t)},getQueryParams:function(){return p},getAppUrl:function(){return t},getHostUrl:function(){return c},setAppUrl:function(n){t=n},setHostUrl:function(n){c=n},startMyTimer:function(){return n.performance.now()},getMyTimer:function(t){return n.performance.now()-t}},version:function(){return s("Hello, spyreqs ver "+it),it}};n.spyreqs=d==2?at(g,["rest","jsom","utils"]):g})(window);